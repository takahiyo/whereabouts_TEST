<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>在席確認表【開発用】</title>

<!-- 強めのキャッシュ抑止（HTMLに効く） -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<!-- CSP：Worker への POST を許可 -->
<meta http-equiv="Content-Security-Policy"
      content="default-src 'self';
               script-src 'self';
               connect-src 'self' https://presence-proxy-test.taka-hiyo.workers.dev;
               style-src 'self' 'unsafe-inline';
               img-src 'self' data:;
               font-src 'self';
               object-src 'none';
               base-uri 'self';
               form-action 'self'">
<link rel="stylesheet" href="styles.css">

</head>
<body>
<header>
    <div class="title-wrap">
      <button id="titleBtn" class="title-btn" aria-haspopup="true" aria-expanded="false" aria-controls="groupMenu">在席確認表【開発用】</button>
      <div id="groupMenu" class="grp-menu" role="menu" aria-labelledby="titleBtn">
        <h4 id="groupMenuTitle">グループにジャンプ</h4>
        <ul id="groupMenuList"></ul>
      </div>
    </div>
    <input id="nameFilter" class="name-filter" type="search" placeholder="氏名検索（入力と同時に絞り込み）" aria-label="氏名検索" />
    <select id="statusFilter" class="status-filter" aria-label="ステータスで絞り込み"></select>
    <button id="noticesBtn" class="notices-btn" title="お知らせ">お知らせ</button>
    <button id="adminBtn" class="admin-btn" title="管理">管理</button>
    <button id="logoutBtn" class="logout-btn" title="ログオフ">ログオフ</button>
    <button id="manualBtn" class="manual-btn" title="マニュアル">マニュアル</button>
  </header>

  <!-- 管理モーダル -->
  <div id="adminModal" class="admin-modal" aria-modal="true" role="dialog">
    <div class="admin-card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
        <h3>管理パネル</h3><button id="adminClose">閉じる</button>
      </div>


      <div class="admin-grid">
        <div class="admin-box">
          <h4>CSVエクスポート</h4>
          <div class="admin-row"><button id="btnExport">ダウンロード</button></div>
          <div class="admin-note">形式：グループ番号,グループ名,表示順,id,氏名,内線,業務時間,ステータス,戻り時間,備考（従来ヘッダも可）</div>
        </div>

        <div class="admin-box">
          <h4>CSVインポート</h4>
          <div class="admin-row"><input type="file" id="csvFile" accept=".csv,text/csv" /><button id="btnImport">取り込み</button></div>
        </div>

        <div class="admin-box">
          <h4>拠点名の変更</h4>
          <div class="admin-row"><input id="renameOfficeName" placeholder="新しい拠点名" /><button id="btnRenameOffice">変更</button></div>
        </div>


        <div class="admin-box">
          <h4>拠点パスワードの変更</h4>
          <div class="admin-row">
            <input id="setPw" placeholder="新パスワード（任意）" />
            <input id="setAdminPw" placeholder="新管理者PW（任意）" />
            <button id="btnSetPw">更新</button>
          </div>
        </div>

        <div class="admin-box">
          <h4>お知らせ管理</h4>
          <div class="admin-note">複数のお知らせを登録できます。タイトルのみ、またはタイトル＋内容を入力してください。</div>
          <div id="noticesEditor" class="notices-editor"></div>
          <div class="admin-row">
            <button id="btnAddNotice">➕ お知らせを追加</button>
            <button id="btnLoadNotices">現在のお知らせを読み込み</button>
            <button id="btnSaveNotices">保存</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- マニュアルモーダル -->
  <div id="manualModal" class="manual-modal" aria-modal="true" role="dialog" aria-labelledby="manualTitle">
    <div class="manual-card" role="document">
      <div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
          <h3 id="manualTitle" style="margin:0;">マニュアル</h3>
          <button id="manualClose" aria-label="閉じる">閉じる</button>
        </div>
        <div class="manual-tabs">
          <button class="manual-tab-btn active" data-tab="user">📖 ユーザー向け</button>
          <button class="manual-tab-btn" data-tab="admin">⚙️ 管理者向け</button>
        </div>
      </div>

      <section id="manualUser" class="manual-section manual-tab-content active">
        <h4>📖 ユーザーマニュアル - 初めての方へ</h4>
        
        <div style="background:#f0f8ff;padding:12px;margin:12px 0;border-left:4px solid #0073bb;border-radius:4px;">
          <strong>💡 このシステムについて</strong><br>
          在席確認表は、チームメンバーの在席状況をリアルタイムで共有するシステムです。<br>
          入力した内容は自動的に保存され、他の人のPCやスマートフォンにも即座に反映されます。
        </div>

        <h5>🔐 1. 初回ログイン（管理者からパスワードを受け取ってください）</h5>
        <ol style="line-height:1.8;">
          <li><strong>拠点を選択</strong>：ドロップダウンから所属する拠点（営業所）を選びます</li>
          <li><strong>パスワードを入力</strong>：管理者から教えてもらったパスワードを入力します</li>
          <li><strong>「ログイン」ボタンをクリック</strong></li>
          <li>✅ ログイン成功すると、在席確認表が表示されます</li>
        </ol>
        <p style="margin:8px 0 16px 0;color:#666;font-size:0.9em;">
          ※ログイン状態は1時間保持され、自動的に延長されます。ブラウザを閉じた場合は再ログインが必要です。
        </p>

        <h5>👁️ 2. 画面の見方</h5>
        <ul style="line-height:1.8;">
          <li><strong>画面上部（ヘッダー）</strong>：
            <ul style="margin-top:4px;">
              <li>📍 <strong>タイトル</strong>：拠点名が表示されます（クリックするとグループ一覧メニューが開きます）</li>
              <li>🔍 <strong>氏名検索</strong>：特定の人を探すときに使います</li>
              <li>🎯 <strong>ステータス絞り込み</strong>：「外出中の人だけ」など、条件で絞り込めます</li>
              <li>📢 <strong>お知らせ</strong>：お知らせがある場合に表示。クリックで折りたたみ/展開を切り替えます</li>
              <li>⚙️ <strong>管理</strong>：管理者のみ表示されます</li>
              <li>🚪 <strong>ログオフ</strong>：ログアウトします</li>
              <li>📖 <strong>マニュアル</strong>：このマニュアルを表示します</li>
            </ul>
          </li>
          <li><strong>メイン画面</strong>：
            <ul style="margin-top:4px;">
              <li>チーム（グループ）ごとに表が表示されます</li>
              <li>各行がメンバー1人の情報です</li>
              <li>スマートフォンでは自動的にカード表示に切り替わります</li>
            </ul>
          </li>
        </ul>

        <h5>✍️ 3. 基本操作 - 自分の状態を更新する</h5>
        
        <p style="margin:8px 0;"><strong>📝 業務時間の入力</strong></p>
        <ol style="line-height:1.8;">
          <li>自分の行の「業務時間」欄をクリック</li>
          <li>直接入力するか、表示される候補リストから選択（例：<code>09:00-17:30</code>）</li>
          <li>✅ 入力が完了すると、約1秒後に自動保存されます（保存ボタンは不要です）</li>
        </ol>

        <p style="margin:16px 0 8px 0;"><strong>🎨 ステータスの選択（色分けされます）</strong></p>
        <table style="width:100%;border-collapse:collapse;margin-bottom:12px;font-size:0.9em;">
          <tr style="background:#f5f5f5;"><th style="padding:6px;border:1px solid #ddd;">ステータス</th><th style="padding:6px;border:1px solid #ddd;">色</th><th style="padding:6px;border:1px solid #ddd;">戻り時間</th><th style="padding:6px;border:1px solid #ddd;">使用例</th></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">在席</td><td style="padding:6px;border:1px solid #ddd;">無色（白）</td><td style="padding:6px;border:1px solid #ddd;">不要</td><td style="padding:6px;border:1px solid #ddd;">デスクにいるとき</td></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">外出</td><td style="padding:6px;border:1px solid #ddd;">🟠 オレンジ</td><td style="padding:6px;border:1px solid #ddd;"><strong>必須</strong></td><td style="padding:6px;border:1px solid #ddd;">銀行、郵便局など</td></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">在宅勤務</td><td style="padding:6px;border:1px solid #ddd;">🟣 紫</td><td style="padding:6px;border:1px solid #ddd;">不要</td><td style="padding:6px;border:1px solid #ddd;">テレワーク中</td></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">出張</td><td style="padding:6px;border:1px solid #ddd;">🔵 水色</td><td style="padding:6px;border:1px solid #ddd;"><strong>必須</strong></td><td style="padding:6px;border:1px solid #ddd;">他拠点や客先へ</td></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">研修</td><td style="padding:6px;border:1px solid #ddd;">🟢 緑</td><td style="padding:6px;border:1px solid #ddd;"><strong>必須</strong></td><td style="padding:6px;border:1px solid #ddd;">研修・セミナー参加</td></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">健康診断</td><td style="padding:6px;border:1px solid #ddd;">🩷 ピンク</td><td style="padding:6px;border:1px solid #ddd;"><strong>必須</strong></td><td style="padding:6px;border:1px solid #ddd;">健康診断受診中</td></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">コアドック</td><td style="padding:6px;border:1px solid #ddd;">💜 薄紫</td><td style="padding:6px;border:1px solid #ddd;"><strong>必須</strong></td><td style="padding:6px;border:1px solid #ddd;">コアドック受診中</td></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">帰宅</td><td style="padding:6px;border:1px solid #ddd;">⚪ 灰色</td><td style="padding:6px;border:1px solid #ddd;">不要</td><td style="padding:6px;border:1px solid #ddd;">退社済み</td></tr>
          <tr><td style="padding:6px;border:1px solid #ddd;">休み</td><td style="padding:6px;border:1px solid #ddd;">🔴 赤</td><td style="padding:6px;border:1px solid #ddd;">不要</td><td style="padding:6px;border:1px solid #ddd;">休暇・欠勤</td></tr>
        </table>

        <p style="margin:16px 0 8px 0;"><strong>⏰ 戻り時間の入力（外出、出張、研修などの場合）</strong></p>
        <ol style="line-height:1.8;">
          <li>ステータスで「外出」「出張」「研修」「健康診断」「コアドック」を選ぶと、戻り時間が<strong style="color:#d00;">必須</strong>になります</li>
          <li>「戻り時間」のドロップダウンをクリックして選択（07:00〜22:00、30分刻み）</li>
          <li>⚠️ 未入力の場合は赤枠で表示されます（必ず入力してください）</li>
        </ol>
        <p style="margin:8px 0;color:#666;font-size:0.9em;">
          💡 ヒント：「在席」「在宅勤務」「帰宅」「休み」を選ぶと、戻り時間と備考が自動的にクリアされます
        </p>

        <p style="margin:16px 0 8px 0;"><strong>📌 備考の入力（任意）</strong></p>
        <ul style="line-height:1.8;">
          <li>「備考」欄をクリックして、自由に入力できます</li>
          <li>候補から選ぶこともできます：<strong>直出</strong>、<strong>直帰</strong>、<strong>直出・直帰</strong></li>
          <li>空白にしたい場合は「（空白）」を選択してください</li>
        </ul>

        <h5>🔍 4. 他の人の状況を確認する</h5>
        
        <p><strong>氏名検索の使い方</strong></p>
        <ol style="line-height:1.8;">
          <li>画面上部の検索ボックスに名前を入力（例：「田中」）</li>
          <li>入力すると同時に、該当する人だけが表示されます</li>
          <li>検索を解除するには、入力内容を削除してください</li>
        </ol>

        <p style="margin-top:12px;"><strong>ステータスで絞り込み</strong></p>
        <ol style="line-height:1.8;">
          <li>画面上部の「ステータス絞り込み」ドロップダウンをクリック</li>
          <li>見たいステータスを選択（例：「外出中の人だけ見る」→「外出」を選択）</li>
          <li>全員表示に戻すには「全て」を選択してください</li>
        </ol>

        <p style="margin-top:12px;"><strong>グループジャンプ（画面が長い場合）</strong></p>
        <ol style="line-height:1.8;">
          <li>画面上部の拠点名（タイトル）をクリック</li>
          <li>グループ一覧メニューが表示されます</li>
          <li>行きたいグループをクリックすると、その位置にスクロールします</li>
        </ol>

        <h5>📢 5. お知らせ機能の使い方</h5>
        <p><strong>お知らせエリアとは</strong></p>
        <ul style="line-height:1.8;">
          <li>管理者が登録した重要なお知らせが、ヘッダーとメイン画面の間に表示されます</li>
          <li>システムメンテナンス、業務連絡、注意事項などが掲載されます</li>
          <li>お知らせがない場合は、お知らせエリアとボタンは表示されません</li>
        </ul>

        <p style="margin-top:12px;"><strong>折りたたみ/展開の切り替え</strong></p>
        <ol style="line-height:1.8;">
          <li><strong>初期状態（ログイン直後）</strong>：お知らせは<strong>展開</strong>された状態で表示されます</li>
          <li><strong>折りたたみ</strong>：ヘッダーの「お知らせ」ボタンをクリック → 最初のお知らせのタイトルと件数のみ表示されます<br>
            <span style="color:#666;font-size:0.9em;">例：「システムメンテナンスのお知らせ (他2件)」</span></li>
          <li><strong>展開</strong>：もう一度「お知らせ」ボタンをクリック → すべてのお知らせが表示されます</li>
        </ol>

        <p style="margin-top:12px;"><strong>お知らせの更新頻度</strong></p>
        <ul style="line-height:1.8;">
          <li>管理者が追加・編集・削除したお知らせは、約30秒ごとに自動的に反映されます</li>
          <li>すぐに確認したい場合は、ページを再読み込み（F5キー）してください</li>
        </ul>

        <h5>🔄 6. 自動更新について（重要）</h5>
        <div style="background:#fff3cd;padding:12px;margin:12px 0;border-left:4px solid #ffc107;border-radius:4px;">
          <strong>⚡ リアルタイム同期</strong>
          <ul style="margin:8px 0;line-height:1.8;">
            <li>✅ あなたが入力した内容は、<strong>約1秒後</strong>に自動的に保存されます</li>
            <li>✅ 他の人が入力した在席状況は、<strong>約10秒ごと</strong>に自動的にあなたの画面に反映されます</li>
            <li>✅ お知らせや設定の変更は、<strong>約30秒ごと</strong>に自動的に反映されます</li>
            <li>✅ 保存ボタンや更新ボタンは<strong>不要</strong>です</li>
            <li>⚠️ 入力中や変換中は、他の人の更新が一時的に保留されます（入力の邪魔になりません）</li>
          </ul>
        </div>

        <h5>❓ よくある質問</h5>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. 保存ボタンはどこですか？</summary>
          <p style="margin:8px 0 8px 20px;">A. 保存ボタンはありません。入力すると自動的に約1秒後に保存されます。</p>
        </details>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. お知らせボタンが表示されません</summary>
          <p style="margin:8px 0 8px 20px;">A. お知らせがない場合、お知らせボタンとお知らせエリアは表示されません。管理者がお知らせを登録すると自動的に表示されます（約30秒以内に反映）。</p>
        </details>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. お知らせが邪魔で画面が見づらい</summary>
          <p style="margin:8px 0 8px 20px;">A. ヘッダーの「お知らせ」ボタンをクリックすると、お知らせエリアを折りたたむことができます。折りたたむと1行のサマリー表示になります。</p>
        </details>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. 戻り時間が選択できません</summary>
          <p style="margin:8px 0 8px 20px;">A. ステータスが「在席」「在宅勤務」「帰宅」「休み」の場合、戻り時間は不要なため選択できません。「外出」「出張」などに変更してください。</p>
        </details>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. スマートフォンでも使えますか？</summary>
          <p style="margin:8px 0 8px 20px;">A. はい、スマートフォンのブラウザでも利用できます。画面が自動的にカード表示に切り替わります。</p>
        </details>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. 間違えて入力してしまいました</summary>
          <p style="margin:8px 0 8px 20px;">A. すぐに正しい内容に入力し直してください。約2秒後に自動保存されます。</p>
        </details>

        <p style="margin-top:16px;font-size:0.95em;">
          <strong>📚 さらに詳しく知りたい方へ</strong><br>
          より詳細な情報は <a href="USER_MANUAL.md" target="_blank" style="color:#0073bb;text-decoration:underline;">詳細マニュアル（USER_MANUAL.md）</a> をご覧ください。
        </p>
      </section>

      <section id="manualAdmin" class="manual-section manual-tab-content">
        <h4>⚙️ 管理者マニュアル</h4>
        
        <div style="background:#fff3cd;padding:12px;margin:12px 0;border-left:4px solid #ffc107;border-radius:4px;">
          <strong>🔐 管理者ログインについて</strong><br>
          管理パネルを表示するには、<strong>管理者パスワード</strong>でログインしてください。<br>
          一般ユーザーパスワードではログインできても「管理」ボタンは表示されません。
        </div>

        <h5>📂 1. CSVエクスポート - データのバックアップ</h5>
        <p><strong>用途</strong>：現在の名簿と在席データをExcelで編集できる形式でダウンロードします</p>
        <ol style="line-height:1.8;">
          <li>画面上部の「管理」ボタンをクリック</li>
          <li>管理パネルが開きます</li>
          <li>「CSVエクスポート」セクションの「ダウンロード」ボタンをクリック</li>
          <li>✅ ファイル <code>presence_<拠点ID>.csv</code> がダウンロードされます</li>
        </ol>
        <p style="margin:8px 0;color:#d00;font-weight:bold;">⚠️ 重要：CSVインポート前に必ずエクスポートでバックアップを取ってください！</p>

        <h5>📥 2. CSVインポート - 名簿の一括登録・更新</h5>
        <p><strong>用途</strong>：Excelで編集した名簿を一括で取り込みます（名簿全体が置き換わります）</p>
        
        <p style="margin:12px 0 8px 0;"><strong>対応しているCSV形式</strong></p>
        <ul style="line-height:1.8;">
          <li><strong>標準形式</strong>：<code>グループ番号,グループ名,表示順,id,氏名,内線,業務時間,ステータス,戻り時間,備考</code></li>
          <li><strong>旧形式</strong>：<code>グループ番号,グループ名,表示順,id,氏名,内線,ステータス,戻り時間,備考</code>（業務時間列なし。既存データから引き継ぎます）</li>
        </ul>

        <p style="margin:12px 0 8px 0;"><strong>操作手順</strong></p>
        <ol style="line-height:1.8;">
          <li><strong style="color:#d00;">【重要】まずエクスポートでバックアップを取る</strong></li>
          <li>ダウンロードしたCSVファイルをExcelで開いて編集</li>
          <li>管理パネルの「CSVインポート」セクションで「ファイルを選択」をクリック</li>
          <li>編集したCSVファイルを選択</li>
          <li>「取り込み」ボタンをクリック</li>
          <li>✅「インポート完了」と表示されたら成功です</li>
        </ol>

        <div style="background:#f8d7da;padding:12px;margin:12px 0;border-left:4px solid #dc3545;border-radius:4px;">
          <strong>⚠️ 注意事項</strong>
          <ul style="margin:8px 0;line-height:1.8;">
            <li>インポートすると<strong>名簿全体が置き換わります</strong>（部分更新はできません）</li>
            <li>CSVに含まれないメンバーは削除されます</li>
            <li>元に戻すにはバックアップのCSVを再インポートしてください</li>
            <li>1行目は必ずヘッダー行にしてください</li>
          </ul>
        </div>

        <h5>🏢 3. 拠点名の変更</h5>
        <ol style="line-height:1.8;">
          <li>管理パネルの「拠点名の変更」セクションに新しい拠点名を入力</li>
          <li>「変更」ボタンをクリック</li>
          <li>✅ 画面タイトルとログイン画面の拠点名が変更されます</li>
        </ol>

        <h5>🔑 4. パスワード変更</h5>
        <p>2種類のパスワードを個別に変更できます：</p>
        <ul style="line-height:1.8;">
          <li><strong>新パスワード</strong>：一般ユーザーがログインするときのパスワード</li>
          <li><strong>新管理者PW</strong>：管理者権限でログインするときのパスワード</li>
        </ul>
        <ol style="line-height:1.8;">
          <li>変更したいパスワード欄に新しいパスワードを入力（両方でも片方でもOK）</li>
          <li>「更新」ボタンをクリック</li>
          <li>✅「パスワードを更新しました」と表示されたら成功です</li>
        </ol>
        <p style="margin:8px 0;color:#666;font-size:0.9em;">
          💡 パスワードは平文で保存されます。<strong>強固なパスワード</strong>を使用してください。
        </p>

        <h5>📢 5. お知らせ管理</h5>
        <p><strong>用途</strong>：拠点のメンバー全員に重要な情報を掲示します</p>
        
        <div style="background:#e7f8e7;padding:12px;margin:12px 0;border-left:4px solid #4ade80;border-radius:4px;">
          <strong>✨ 自動読み込み機能</strong><br>
          管理パネルを開くと、現在のお知らせが<strong>自動的に表示</strong>されます。<br>
          「現在のお知らせを読み込み」ボタンを押す必要はありません。
        </div>

        <p style="margin:12px 0 8px 0;"><strong>お知らせの追加</strong></p>
        <ol style="line-height:1.8;">
          <li>管理パネルを開く（現在のお知らせが自動表示されます）</li>
          <li>「➕ お知らせを追加」ボタンをクリック → 入力欄が追加されます</li>
          <li><strong>タイトル</strong>（最大200文字）と<strong>内容</strong>（最大2000文字）を入力</li>
          <li>「保存」ボタンをクリック</li>
          <li>✅ お知らせが即座に保存され、約30秒以内に全ユーザーの画面に表示されます</li>
        </ol>

        <p style="margin:12px 0 8px 0;"><strong>お知らせの編集</strong></p>
        <ol style="line-height:1.8;">
          <li>編集したいお知らせの「編集」ボタンをクリック</li>
          <li>入力欄に内容が表示されるので、修正します</li>
          <li>「保存」ボタンをクリック</li>
        </ol>

        <p style="margin:12px 0 8px 0;"><strong>お知らせの削除</strong></p>
        <ol style="line-height:1.8;">
          <li>削除したいお知らせの「削除」ボタンをクリック</li>
          <li>確認ダイアログで「OK」をクリック</li>
        </ol>

        <div style="background:#d1ecf1;padding:12px;margin:12px 0;border-left:4px solid #0c5460;border-radius:4px;">
          <strong>💡 お知らせ機能のポイント</strong>
          <ul style="margin:8px 0;line-height:1.8;">
            <li>お知らせは<strong>拠点ごと</strong>に独立して管理されます</li>
            <li>1拠点あたり<strong>最大20件</strong>まで登録できます</li>
            <li>お知らせは<strong>追加した順</strong>（古い順）に表示されます</li>
            <li>HTML/スクリプトは自動的に無効化されます（セキュリティ対策）</li>
            <li>全ユーザーの画面に<strong>約30秒以内</strong>に自動反映されます</li>
          </ul>
        </div>

        <p style="margin:12px 0 8px 0;"><strong>お知らせの用途例</strong></p>
        <ul style="line-height:1.8;">
          <li>🔧 システムメンテナンスの予定</li>
          <li>📅 全体会議やイベントの案内</li>
          <li>⚠️ 業務上の注意事項</li>
          <li>🎉 新機能の案内</li>
          <li>📢 重要な連絡事項</li>
        </ul>

        <h5>📋 運用上の注意事項</h5>
        <ul style="line-height:1.8;">
          <li>💾 <strong>バックアップは必須</strong>：重要な操作の前に必ずCSVエクスポートでバックアップを取ってください</li>
          <li>👥 <strong>複数管理者の同時操作は避ける</strong>：競合してデータが失われる可能性があります</li>
          <li>🔄 <strong>定期バックアップ</strong>：週1回程度、定期的にCSVエクスポートすることを推奨します</li>
          <li>🔒 <strong>パスワード管理</strong>：パスワードは平文保存のため、強固なものを使い、関係者以外に漏らさないでください</li>
        </ul>

        <h5>❓ よくある質問（管理者向け）</h5>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. CSVインポートで「CSVヘッダが不正です」と出る</summary>
          <p style="margin:8px 0 8px 20px;">A. 1行目のヘッダーが正しい形式か確認してください。エクスポートしたCSVの1行目をそのまま使うのが確実です。</p>
        </details>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. 誤ってメンバーを削除してしまった</summary>
          <p style="margin:8px 0 8px 20px;">A. 削除前のバックアップCSVを再インポートしてください。バックアップがない場合は手動でCSVを作成する必要があります。</p>
        </details>
        <details style="margin:8px 0;">
          <summary style="cursor:pointer;font-weight:bold;padding:4px 0;">Q. メニュー設定のJSONが正しいか不安</summary>
          <p style="margin:8px 0 8px 20px;">A. オンラインのJSONバリデーター（例：jsonlint.com）で確認できます。保存時にエラーが出た場合は「現在の設定を読み込み」で元に戻してください。</p>
        </details>

        <p style="margin-top:16px;font-size:0.95em;">
          <strong>📚 さらに詳しく知りたい方へ</strong><br>
          より詳細な情報は <a href="ADMIN_MANUAL.md" target="_blank" style="color:#0073bb;text-decoration:underline;">管理者向け詳細マニュアル（ADMIN_MANUAL.md）</a> をご覧ください。
        </p>
      </section>
    </div>
  </div>

  <!-- ログイン -->
  <div id="login" class="login" style="display:none">
    <div class="card">
      <h2>在席確認表【開発用】</h2>
      <p>拠点を選び、パスワードを入力してください</p>
      <select id="officeSel" aria-label="拠点"></select>
      <input type="password" id="pw" placeholder="Password" autocomplete="current-password" />
      <button id="btnLogin">ログイン</button>
      <div id="loginMsg" style="color:#0073bb;margin-top:8px" aria-live="polite"></div>
    </div>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>
  
  <!-- お知らせエリア -->
  <div id="noticesArea" class="notices-area" style="display:none">
    <div class="notices-container">
      <div class="notices-header">
        <h3 class="notices-title">📢 お知らせ</h3>
        <span id="noticesSummary" class="notices-summary" style="display:none"></span>
      </div>
      <div id="noticesList" class="notices-list"></div>
    </div>
  </div>

  <div class="wrap"><div id="board" class="board" style="display:none"></div></div>
  <div id="diag" class="diag"></div>
  <script src="config.js"></script>
　<script src="js/globals.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/layout.js"></script>
  <script src="js/filters.js"></script>
  <script src="js/board.js"></script>
  <script src="js/offices.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/sync.js"></script>
  <script src="js/admin.js"></script>
  <script src="js/notices.js"></script>
  <script src="main.js"></script>

</body>
</html>
