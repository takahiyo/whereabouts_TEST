  :root{
    /* === v1.42 の幅パラメータを踏襲 === */
    --base-name:   110px;
    --base-ext:     70px;
    --base-work:   170px;
    --base-status: 150px;
    --base-time:    65px;
    --base-note:   210px;

    --scale-name:   0.50;
    --scale-ext:    0.33;
    --scale-work:   0.55;
    --scale-status: 0.75;
    --scale-time:   0.45;

    --min-name:    85px;
    --min-ext:     35px;
    --min-work:    80px;
    --min-status:  85px;
    --min-time:    65px;
    --min-note:    70px;

    --w-name:   max(calc(var(--base-name)   * var(--scale-name)),   var(--min-name));
    --w-ext:    max(calc(var(--base-ext)    * var(--scale-ext)),    var(--min-ext));
    --w-work:   max(calc(var(--base-work)   * var(--scale-work)),   var(--min-work));
    --w-status: max(calc(var(--base-status) * var(--scale-status)), var(--min-status));
    --w-time:   max(calc(var(--base-time)   * var(--scale-time)),   var(--min-time));
    --w-note:   max(var(--base-note), var(--min-note));

    --status-effective: var(--status-fixed, var(--w-status));

    --gap: 20px;
    --line:#d9d9d9; --head:#f1ece6; --bg:#fafafa;
    --header-height: 56px;
  }

  body{font-family:"Segoe UI","Hiragino Kaku Gothic ProN",Meiryo,sans-serif;background:#fff;margin:16px}

  /* ヘッダ */
  header{
    position:relative;
    position: sticky; top: 0; z-index: 1500;
    display:flex; gap:8px; align-items:center; justify-content:center;
    margin-bottom:12px; flex-wrap:wrap; background:#fff;
    padding:6px 0; box-shadow: 0 1px 0 rgba(0,0,0,.06);
  }
  .title-wrap{ position:relative; }
  header .title-btn, header .admin-btn, header .logout-btn, header .manual-btn{
    font-size:14px; font-weight:600; color:#1f2937;
    padding:.35rem .9rem; border-radius:999px; line-height:1.2; border:1px solid transparent; cursor:pointer;
  }
  header .title-btn{ background:#dff1ff; border-color:#bfe4ff; }
  header .admin-btn{ background:#e7f8e7; border-color:#b7e6b7; display:none; }
  header .logout-btn{ background:#fee2e2; border-color:#fecaca; display:none; }
  header .manual-btn{ background:#eef2ff; border-color:#c7d2fe; display:none; }

  /* フィルタUI（ログイン後のみ表示） */
  .name-filter, .status-filter{
    display:none;
    padding:.35rem .6rem; border:1px solid var(--line); border-radius:999px;
    font-size:14px;
  }
  .name-filter{ min-width:220px; max-width:50vw; }
  .status-filter{ min-width:170px; }

  /* ヘッダ内の検索ボックスの固定幅 */
  header #nameFilter,
  header .name-filter{
    display: inline-block;
    width: clamp(220px, 32vw, 360px) !important;
    min-width: 220px;
    max-width: 50vw;
    flex: 0 0 auto;
  }
  header #statusFilter,
  header .status-filter{
    display: inline-block;
    width: clamp(170px, 22vw, 240px) !important;
    min-width: 170px;
    flex: 0 0 auto;
  }

  /* 盤面 */
  .wrap{width:100%; margin:0 auto;}
  .board{
    display:grid; gap:var(--gap);
    grid-template-columns: repeat(var(--cols, auto-fit), minmax(min(100%, 760px), 1fr));
  }
  .board[data-cols="1"]{ grid-template-columns: 1fr; }
  #board.force-cards {
    grid-template-columns: 1fr;
  }

  .panel{ border:1px solid var(--line); border-radius:6px; background:var(--bg); padding:8px; overflow:auto;
  scroll-margin-top: calc(var(--header-height) + 12px); }

  table{width:100%; border-collapse:separate; border-spacing:0; table-layout:fixed}
  thead th{position:sticky; top:0; background:#f2efe9; font-weight:700}
  th,td{border:1px solid var(--line); padding:6px; font-size:14px}
  th{text-align:left}

  col.col-name{width:var(--w-name)}
  col.col-ext{width:var(--w-ext)}
  col.col-work{width:var(--w-work)}
  col.col-status{width:var(--status-effective)}
  col.col-time{width:var(--w-time)}
  col.col-note{width:var(--w-note)}

  select,input[type="text"],input[type="search"]{width:100%; box-sizing:border-box; padding:.3rem .35rem; border:1px solid var(--line); border-radius:4px; background:#fff; font-size:14px; appearance:auto; -webkit-appearance:auto}
  td.status select{padding-right:2.6em}
  td.time   select{text-align-last:center; font-variant-numeric:tabular-nums}
  td.work   input{font-variant-numeric:tabular-nums; letter-spacing:.02em; text-align:center;}

  /* ステータス別の行色（在席はデフォルト） */
  #board tbody tr{ transition: background-color .15s ease; }
  #board tbody tr.st-here{ background: transparent; }
  #board tbody tr.st-out{ background:#fff7ed; box-shadow: inset 4px 0 0 #f59e0b; }
  #board tbody tr.st-meeting{ background:#eff6ff; box-shadow: inset 4px 0 0 #3b82f6; }
  #board tbody tr.st-remote{ background:#f5f3ff; box-shadow: inset 4px 0 0 #8b5cf6; }
  #board tbody tr.st-trip{ background:#ecfdf5; box-shadow: inset 4px 0 0 #10b981; }
  #board tbody tr.st-training{ background:#fefce8; box-shadow: inset 4px 0 0 #eab308; }
  #board tbody tr.st-health{ background:#f0f9ff; box-shadow: inset 4px 0 0 #06b6d4; }
  #board tbody tr.st-coadoc{ background:#fdf2f8; box-shadow: inset 4px 0 0 #db2777; }
  #board tbody tr.st-home{ background:#f3f4f6; box-shadow: inset 4px 0 0 #6b7280; }
  #board tbody tr.st-off{ background:#fef2f2; box-shadow: inset 4px 0 0 #ef4444; color:#374151; }
  #board tbody tr.st-off input, #board tbody tr.st-off select{ color:#374151; }

  /* 戻り時間入力の促し（外出/会議） */
  td.time{ position:relative; }
  td.time.need-time select{
    border-color:#ef4444 !important;
    box-shadow:0 0 0 3px rgba(239,68,68,.25);
    animation:pulseRing 1.2s ease-in-out infinite;
  }
  .time-hint{
    position:absolute; right:8px; top:50%; transform:translateY(-50%);
    font-size:12px; color:#b91c1c; pointer-events:none; user-select:none;
  }
  @keyframes pulseRing{
    0%{   box-shadow:0 0 0 3px rgba(239,68,68,.25); }
    70%{  box-shadow:0 0 0 6px rgba(239,68,68,.06); }
    100%{ box-shadow:0 0 0 3px rgba(239,68,68,.25); }
  }

  .login{position:fixed; inset:0; background:#fff; display:flex; align-items:center; justify-content:center; z-index:2200}
  .login .card{background:#fff; border-radius:8px; padding:20px; min-width:300px; max-width:90vw; text-align:center}

  .toast{position:fixed;top:20px;right:20px;background:#333;color:#fff;padding:8px 12px;border-radius:4px;font-size:12px;opacity:0;transition:.25s;z-index:2000}
  .toast.show{opacity:1}

  @media (max-width: 720px){
    colgroup, thead{ display:none; }
    table{ table-layout:auto; }
    tbody{ display:block; }
    tbody tr{ display:flex; flex-wrap:wrap; gap:8px 12px; border:1px solid var(--line); border-radius:10px; padding:10px; margin:10px 0; }
    tbody td{ border:none; padding:0; display:flex; align-items:center; gap:8px; flex:1 1 48%; min-width:140px; background:transparent; }
    #board tbody td::before{
      content: attr(data-label) !important;
      font-weight:600; color:#6B7280;
      min-width:5.5em; flex:0 0 auto;
    }
    tbody td.name{ order:0; flex:1 1 100%; font-weight:800; font-size:15px; line-height:1.2; padding-bottom:2px; }
    tbody td.name::before{ content:""; display:none; }
    tbody td.work{ order:1; flex:1 1 100%; }
    tbody td.ext{ order:2; }
    tbody td.time{ order:3; }
    tbody td.status{ order:4; flex:1 1 100%; }
    tbody td.note{ order:5; flex:1 1 100%; }
  }

  #board.force-cards colgroup,
  #board[data-cols="1"] colgroup,
  #board.force-cards thead,
  #board[data-cols="1"] thead{ display:none; }

  #board.force-cards tbody,
  #board[data-cols="1"] tbody{ display:block; }

  #board.force-cards tbody tr,
  #board[data-cols="1"] tbody tr{
    display:flex; flex-wrap:wrap; gap:8px 12px;
    border:1px solid var(--line); border-radius:10px;
    padding:10px; margin:10px 0;
  }

  #board.force-cards tbody td,
  #board[data-cols="1"] tbody td{
    border:none; padding:0;
    display:flex; align-items:center; gap:8px;
    flex:1 1 48%; min-width:140px; background:transparent;
  }

  #board.force-cards tbody td::before,
  #board[data-cols="1"] tbody td::before{
    font-weight:600; color:#6B7280;
    min-width:5.5em; flex:0 0 auto;
  }

  #board.force-cards tbody td.name,
  #board[data-cols="1"] tbody td.name{
    order:0; flex:1 1 100%;
    font-weight:800; font-size:15px; line-height:1.2;
    padding-bottom:2px;
  }

  #board.force-cards tbody td.work,
  #board[data-cols="1"] tbody td.work{
    order:1; flex:1 1 100%;
  }

  #board.force-cards tbody td.ext,
  #board[data-cols="1"] tbody td.ext{ order:2; }

  #board.force-cards tbody td.time,
  #board[data-cols="1"] tbody td.time{ order:3; }

  #board.force-cards tbody td.status,
  #board[data-cols="1"] tbody td.status{
    order:4; flex:1 1 100%;
  }

  #board.force-cards tbody td.note,
  #board[data-cols="1"] tbody td.note{ order:5; flex:1 1 100%; }

  #board.force-cards tbody td.name::before,
  #board[data-cols="1"] tbody td.name::before{
    content:""; display:none;
  }

  /* 1列になったら強制カード化 */

.board.force-cards table{
    display:block;
    width:100%;
    table-layout:auto;
    border-collapse:separate;
  }

  /* 診断用バナー（必要時のみ） */
  .diag{ position:fixed; left:8px; bottom:8px; background:#fffbdd; border:1px solid #e6cf00; color:#614a00;
         padding:6px 8px; border-radius:6px; font-size:12px; z-index:2500; display:none; }
  .diag.show{ display:block; }

  /* v1.431: duplicate-label fix */
  .sr-only{
    position:absolute !important;
    width:1px; height:1px;
    padding:0; margin:-1px;
    overflow:hidden; clip:rect(0,0,0,0);
    white-space:nowrap; border:0;
  }
  @media (min-width: 721px){
    #board:not(.force-cards) tbody td::before{ content: "" !important; }
  }
  #board.force-cards td > label.sr-only{ display:none !important; }
  #board.force-cards tbody td::before{
    content: attr(data-label) !important;
    white-space:nowrap;
  }
  .admin-modal{position:fixed;inset:0;z-index:1850;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.5);}
  .admin-modal.show{display:flex;}
  .admin-card{background:#fff;border:1px solid var(--line);border-radius:12px;padding:16px;max-height:80vh;overflow:auto;}
  .admin-tabs{ }
  .tab-buttons{display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap;}
  .tab-btn{padding:.35rem .9rem;border:1px solid var(--line);border-radius:6px;background:#f3f4f6;cursor:pointer;}
  .tab-btn.active{background:#e7f8e7;border-color:#b7e6b7;}
  .tab-panel{display:none;}
  .tab-panel.active{display:block;}
  .admin-box{margin-bottom:16px;}
  .admin-row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:8px;}
  .admin-note{font-size:12px;color:#6B7280;margin-top:4px;}
  /* マニュアルモーダル */
  .manual-modal{ position:fixed; inset:0; z-index:1850; display:none; }
  .manual-modal.show{ display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.5); }
  .manual-card{
    background:#fff; border:1px solid var(--line); border-radius:12px; padding:16px;
    width:min(960px, 94vw); max-height:80vh; overflow:auto;
  }
  .manual-section{ margin-bottom:16px; }
  .manual-section h4{ margin:8px 0; }
  .manual-section table{ width:100%; border-collapse:collapse; font-size:14px; }
  .manual-section table th, .manual-section table td{ border:1px solid #ddd; padding:6px; }
.grp-menu{
  position:absolute; top:100%; left:0;
  min-width:100%;
  width:max-content;
  max-width:calc(100vw - 32px);
  background:#dff1ff; border:1px solid #bfe4ff; border-radius:8px; padding:4px 0;
  max-height:calc(100vh - var(--header-height) - 20px); overflow:auto;
  box-shadow:0 4px 8px rgba(0,0,0,.08);
  z-index:1600;
  transition:opacity .15s ease; opacity:0; pointer-events:none;
}
.grp-menu.show{opacity:1; pointer-events:auto;}
.grp-menu h4{margin:0 0 4px; padding:0 12px; font-size:14px; font-weight:600; color:#1f2937;}
.grp-menu ul{list-style:none; margin:0; padding:0;}
.grp-menu li{margin:0;}
.grp-menu button.grp-item{
  display:block; width:100%;
  background:transparent; border:none;
  padding:4px 12px; border-radius:4px;
  text-align:left; font-size:14px; font-weight:600; color:#1f2937; cursor:pointer;
    white-space:nowrap;
}
.grp-menu button.grp-item:hover{background:#bfe4ff;}
